<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pay Almost Zero Taxes, Legally | Nigeria Tax Calculator</title>
    
    <!-- External Libraries -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: #2d3748;
            text-align: center;
            margin-bottom: 10px;
            font-size: 32px;
        }

        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .value-prop {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            color: white;
            text-align: center;
        }

        .plans {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .plans {
                grid-template-columns: 1fr;
            }
        }

        .plan {
            background: white;
            border: 3px solid #e2e8f0;
            padding: 25px;
            border-radius: 15px;
        }

        .plan.basic {
            border-color: #ff9800;
            transform: scale(1.05);
        }

        .plan.pro {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .plan-btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 25px;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            margin-top: 20px;
            transition: transform 0.2s;
        }

        .plan-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .free-btn {
            background: #667eea;
            color: white;
        }

        .basic-btn {
            background: #ff9800;
            color: white;
        }

        .pro-btn {
            background: white;
            color: #667eea;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            overflow-y: auto;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            margin: 20px;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 16px;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 100%;
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .alert-success {
            background: #d4edda;
            border: 2px solid #28a745;
            color: #155724;
        }

        .alert-error {
            background: #f8d7da;
            border: 2px solid #dc3545;
            color: #721c24;
        }

        .alert-warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            color: #856404;
        }

        .info-box {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #2196f3;
            margin: 20px 0;
        }

        .success-box {
            background: #d4edda;
            border: 2px solid #28a745;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            color: #155724;
        }

        .upload-zone {
            border: 3px dashed #cbd5e0;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin: 20px 0;
        }

        .upload-zone:hover {
            border-color: #667eea;
            background: #edf2f7;
        }

        .upload-zone.dragover {
            border-color: #667eea;
            background: #e3f2fd;
        }

        .compliance-badge {
            background: #f7fafc;
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
            border-left: 4px solid #28a745;
        }

        .registered-user {
            background: #e8f5e9;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #4caf50;
            margin: 15px 0;
        }

        .file-input {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üíº Pay Almost Zero Taxes, Legally</h1>
        <p class="subtitle">Maximize your deductions and minimize your tax bill with Nigeria's smartest tax calculator</p>
        
        <!-- Main Landing Page -->
        <div id="landingPage">
            <!-- Value Proposition -->
            <div class="value-prop">
                <h2 style="color: white; margin-bottom: 15px; font-size: 24px;">üéØ How It Works</h2>
                <p style="font-size: 16px; opacity: 0.95; line-height: 1.6; max-width: 800px; margin: 0 auto;">
                    Upload your bank statements, and our AI automatically categorizes every transaction to maximize your <strong>legitimate tax deductions</strong>. Get every allowable relief‚Äîpension, NHF, CRA, and more‚Äîcalculated perfectly under both old and new Nigerian tax laws.
                </p>
            </div>

            <!-- Pricing Plans -->
            <div class="plans">
                <!-- FREE PLAN -->
                <div class="plan">
                    <div style="background: #e2e8f0; color: #4a5568; padding: 8px; border-radius: 15px; display: inline-block; font-size: 11px; font-weight: bold; margin-bottom: 15px;">FREE</div>
                    <h3 style="margin-bottom: 10px;">Manual Entry</h3>
                    <div style="font-size: 36px; font-weight: bold; margin: 15px 0;">‚Ç¶0</div>
                    <p style="color: #718096; font-size: 13px; margin-bottom: 20px;">Perfect for simple calculations</p>
                    
                    <div style="margin: 20px 0; font-size: 13px;">
                        <div style="margin: 5px 0;">‚úì Manual tax calculation</div>
                        <div style="margin: 5px 0;">‚úì Old & new laws</div>
                        <div style="margin: 5px 0;">‚úì Email results</div>
                        <div style="margin: 5px 0; color: #cbd5e0;">‚úó Bank statement upload</div>
                        <div style="margin: 5px 0; color: #cbd5e0;">‚úó AI categorization</div>
                    </div>
                    
                    <button class="plan-btn free-btn" onclick="selectFree()">
                        Get Started Free
                    </button>
                </div>

                <!-- BASIC PLAN -->
                <div class="plan basic">
                    <div style="background: #ff9800; color: white; padding: 8px; border-radius: 15px; display: inline-block; font-size: 11px; font-weight: bold; margin-bottom: 15px;">RECOMMENDED</div>
                    <h3 style="margin-bottom: 10px;">Basic Plan</h3>
                    <div style="font-size: 36px; font-weight: bold; color: #ff9800; margin: 15px 0;">‚Ç¶500</div>
                    <p style="color: #718096; font-size: 13px; margin-bottom: 20px;">Pay per upload (one-time)</p>
                    
                    <div style="margin: 20px 0; font-size: 13px;">
                        <div style="margin: 5px 0;">‚úì Everything in Free</div>
                        <div style="margin: 5px 0;">‚úì <strong>ONE upload</strong></div>
                        <div style="margin: 5px 0;">‚úì AI categorization</div>
                        <div style="margin: 5px 0;">‚úì Tax tips</div>
                        <div style="margin: 5px 0; color: #cbd5e0;">‚úó Multi-bank</div>
                        <div style="margin: 5px 0; color: #cbd5e0;">‚úó Unlimited uploads</div>
                    </div>
                    
                    <button class="plan-btn basic-btn" onclick="selectBasic()">
                        Pay ‚Ç¶500 Per Upload
                    </button>
                    <div style="text-align: center; margin-top: 10px; font-size: 11px; color: #718096;">
                        Try once, upgrade anytime
                    </div>
                </div>

                <!-- PRO PLAN -->
                <div class="plan pro">
                    <div style="background: rgba(255,255,255,0.3); color: white; padding: 8px; border-radius: 15px; display: inline-block; font-size: 11px; font-weight: bold; margin-bottom: 15px;">BEST VALUE</div>
                    <h3 style="margin-bottom: 10px;">Pro Plan</h3>
                    <div style="font-size: 36px; font-weight: bold; margin: 15px 0;">‚Ç¶3,000</div>
                    <p style="opacity: 0.9; font-size: 13px; margin-bottom: 20px;">Full year unlimited access</p>
                    
                    <div style="margin: 20px 0; font-size: 13px;">
                        <div style="margin: 5px 0;">‚úì Everything in Basic</div>
                        <div style="margin: 5px 0;">‚úì <strong>UNLIMITED uploads</strong></div>
                        <div style="margin: 5px 0;">‚úì Multi-bank compilation</div>
                        <div style="margin: 5px 0;">‚úì Advanced optimization</div>
                        <div style="margin: 5px 0;">‚úì Priority support</div>
                        <div style="margin: 5px 0;">‚úì Valid entire tax year</div>
                    </div>
                    
                    <button class="plan-btn pro-btn" onclick="selectPro()">
                        Get Pro (Best Deal)
                    </button>
                    <div style="text-align: center; margin-top: 10px; font-size: 11px; opacity: 0.9;">
                        Save 83% vs 6 Basic uploads
                    </div>
                </div>
            </div>

            <!-- Compliance Badge -->
            <div class="compliance-badge">
                <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap; justify-content: center;">
                    <div style="font-size: 40px;">‚úì</div>
                    <div style="flex: 1; min-width: 250px;">
                        <h3 style="color: #2d3748; margin-bottom: 8px; font-size: 18px;">100% Legal & Compliant</h3>
                        <p style="color: #718096; margin: 0; font-size: 14px; line-height: 1.6;">
                            All calculations follow FIRS guidelines and Nigerian tax laws. We help you claim every legitimate deduction you're entitled to‚Äînothing more, nothing less. Full compliance with PITA 2025 and the new Tax Act 2026.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Free Plan Calculator (Hidden by default) -->
        <div id="freeCalculator" style="display: none;"></div>

        <!-- Paid Plan Upload Section (Hidden by default) -->
        <div id="uploadSection" style="display: none;"></div>

        <!-- PAYMENT MODAL -->
        <div class="modal" id="paymentModal">
            <div class="modal-content">
                <h2 id="modalTitle">üí≥ Complete Your Payment</h2>
                
                <div id="priceSummary" style="background: #e3f2fd; padding: 20px; border-radius: 10px; text-align: center; margin: 20px 0;">
                    <!-- Dynamic content -->
                </div>

                <label style="font-weight: bold;">Email Address</label>
                <input type="email" id="paymentEmail" placeholder="your.email@example.com">
                <small style="color: #718096; font-size: 12px; display: block; margin-top: -5px; margin-bottom: 10px;">
                    üí° If you have complimentary access, we'll detect it automatically
                </small>

                <label style="font-weight: bold;">Full Name</label>
                <input type="text" id="paymentName" placeholder="John Doe">

                <div style="background: #fff3e0; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #ff9800;">
                    <p style="margin: 0; font-size: 13px; color: #e65100;">
                        <strong>üîí Secure Payment:</strong> You'll be redirected to Paystack to complete your payment securely.
                    </p>
                </div>

                <button class="btn btn-primary" onclick="processPayment()" style="margin-bottom: 10px;">
                    Proceed to Payment
                </button>
                
                <button class="btn btn-secondary" onclick="closePaymentModal()">
                    Cancel
                </button>
            </div>
        </div>

        <!-- Name Confirmation Modal -->
        <div class="modal" id="confirmModal">
            <div class="modal-content">
                <h2 style="color: #2d3748; margin-bottom: 15px;">Confirm Your Details</h2>
                <div id="confirmDetails"></div>
                <button class="btn btn-primary" onclick="confirmAndRegister()" style="margin-bottom: 10px;">
                    ‚úì Confirm and Continue
                </button>
                <button class="btn btn-secondary" onclick="closeConfirmModal()">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // CONFIGURATION
        // ============================================
        const EMAILJS_PUBLIC_KEY = "YOUR_PUBLIC_KEY_HERE";
        const EMAILJS_SERVICE_ID = "YOUR_SERVICE_ID_HERE";
        const EMAILJS_TEMPLATE_ID = "YOUR_TEMPLATE_ID_HERE";
        
        const MANUAL_SUBSCRIPTIONS = {
            "kwadonzeh@gmail.com": { 
                plan: "pro", 
                expiryDate: null,
                note: "Developer account"
            },
            "test@example.com": { 
                plan: "basic", 
                expiryDate: "2026-12-31",
                note: "Test account"
            }
        };

        const USER_STORAGE_KEY = 'taxCalc_userRegistry';

        // Initialize EmailJS
        (function(){
            if (EMAILJS_PUBLIC_KEY !== "YOUR_PUBLIC_KEY_HERE") {
                emailjs.init(EMAILJS_PUBLIC_KEY);
            }
        })();

        let selectedPlan = null;
        let currentUserEmail = null;
        let currentUserName = null;
        let currentFile = null;
        let extractedName = null;

        // ============================================
        // USER REGISTRY FUNCTIONS
        // ============================================
        
        function getUserRegistry() {
            const data = localStorage.getItem(USER_STORAGE_KEY);
            return data ? JSON.parse(data) : {};
        }

        function saveUserRegistry(registry) {
            localStorage.setItem(USER_STORAGE_KEY, JSON.stringify(registry));
        }

        function registerUser(email, name) {
            const registry = getUserRegistry();
            registry[email.toLowerCase()] = {
                name: name,
                registeredDate: new Date().toISOString(),
                uploadCount: 0,
                lastUpload: null
            };
            saveUserRegistry(registry);
            console.log('‚úì User registered:', email, '‚Üí', name);
        }

        function getRegisteredUser(email) {
            const registry = getUserRegistry();
            return registry[email.toLowerCase()] || null;
        }

        function updateUploadStats(email) {
            const registry = getUserRegistry();
            const user = registry[email.toLowerCase()];
            if (user) {
                user.uploadCount++;
                user.lastUpload = new Date().toISOString();
                saveUserRegistry(registry);
            }
        }

        function checkManualSubscription(email) {
            const emailLower = email.toLowerCase().trim();
            const subscription = MANUAL_SUBSCRIPTIONS[emailLower];
            
            if (!subscription) {
                return { hasAccess: false, plan: 'free' };
            }
            
            if (subscription.expiryDate) {
                const expiryDate = new Date(subscription.expiryDate);
                const today = new Date();
                
                if (today > expiryDate) {
                    return { 
                        hasAccess: false, 
                        plan: 'free',
                        expired: true,
                        expiryDate: subscription.expiryDate
                    };
                }
            }
            
            console.log('‚úì Manual subscription found:', email, '‚Üí', subscription.plan);
            return { 
                hasAccess: true, 
                plan: subscription.plan,
                expiryDate: subscription.expiryDate,
                note: subscription.note
            };
        }

        // ============================================
        // NAME EXTRACTION FROM BANK STATEMENTS
        // ============================================

        async function extractNameFromPDF(file) {
            console.log('Extracting name from PDF...');
            
            return new Promise((resolve, reject) => {
                const fileReader = new FileReader();
                
                fileReader.onload = async function() {
                    try {
                        const typedarray = new Uint8Array(this.result);
                        const pdf = await pdfjsLib.getDocument(typedarray).promise;
                        
                        let fullText = '';
                        const pagesToRead = Math.min(2, pdf.numPages);
                        
                        for (let i = 1; i <= pagesToRead; i++) {
                            const page = await pdf.getPage(i);
                            const textContent = await page.getTextContent();
                            const pageText = textContent.items.map(item => item.str).join(' ');
                            fullText += pageText + ' ';
                        }
                        
                        console.log('PDF text extracted');
                        const name = findAccountHolderName(fullText);
                        resolve(name);
                    } catch (error) {
                        console.error('PDF extraction error:', error);
                        reject(error);
                    }
                };
                
                fileReader.onerror = reject;
                fileReader.readAsArrayBuffer(file);
            });
        }

        async function extractNameFromExcel(file) {
            console.log('Extracting name from Excel...');
            
            return new Promise((resolve, reject) => {
                const fileReader = new FileReader();
                
                fileReader.onload = function(e) {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                        const sheetText = XLSX.utils.sheet_to_txt(firstSheet);
                        
                        console.log('Excel text extracted');
                        const name = findAccountHolderName(sheetText);
                        resolve(name);
                    } catch (error) {
                        console.error('Excel extraction error:', error);
                        reject(error);
                    }
                };
                
                fileReader.onerror = reject;
                fileReader.readAsArrayBuffer(file);
            });
        }

        async function extractNameFromCSV(file) {
            console.log('Extracting name from CSV...');
            
            return new Promise((resolve, reject) => {
                const fileReader = new FileReader();
                
                fileReader.onload = function(e) {
                    try {
                        const csvText = e.target.result;
                        console.log('CSV text extracted');
                        const name = findAccountHolderName(csvText);
                        resolve(name);
                    } catch (error) {
                        console.error('CSV extraction error:', error);
                        reject(error);
                    }
                };
                
                fileReader.onerror = reject;
                fileReader.readAsText(file);
            });
        }

        function findAccountHolderName(text) {
            const patterns = [
                /Account\s*Name\s*[:\-]?\s*([A-Z][A-Z\s]+)/i,
                /Customer\s*Name\s*[:\-]?\s*([A-Z][A-Z\s]+)/i,
                /Name\s*[:\-]?\s*([A-Z][A-Z\s]+)/i,
                /Account\s*Holder\s*[:\-]?\s*([A-Z][A-Z\s]+)/i,
                /Acct\s*Name\s*[:\-]?\s*([A-Z][A-Z\s]+)/i,
            ];
            
            for (const pattern of patterns) {
                const match = text.match(pattern);
                if (match && match[1]) {
                    const name = match[1].trim();
                    const words = name.split(/\s+/).filter(w => w.length >= 2);
                    if (words.length >= 2 && name.length <= 50) {
                        console.log('‚úì Name found:', name);
                        return name;
                    }
                }
            }
            
            console.warn('‚ö† Name not found');
            return null;
        }

        // ============================================
        // PLAN SELECTION FUNCTIONS
        // ============================================

        function selectFree() {
            console.log('‚úì FREE PLAN SELECTED');
            selectedPlan = 'free';
            showFreeCalculator();
        }

        function selectBasic() {
            console.log('‚úì BASIC PLAN SELECTED');
            selectedPlan = 'basic';
            showPaymentModal('basic');
        }

        function selectPro() {
            console.log('‚úì PRO PLAN SELECTED');
            selectedPlan = 'pro';
            showPaymentModal('pro');
        }

        function showPaymentModal(plan) {
            const modal = document.getElementById('paymentModal');
            const summary = document.getElementById('priceSummary');
            
            if (plan === 'basic') {
                summary.innerHTML = `
                    <div style="font-size: 36px; font-weight: bold; color: #ff9800;">‚Ç¶500</div>
                    <div style="font-size: 14px; color: #666; margin-top: 5px;">One-time payment for one upload</div>
                `;
            } else {
                summary.innerHTML = `
                    <div style="font-size: 36px; font-weight: bold; color: #667eea;">‚Ç¶3,000</div>
                    <div style="font-size: 14px; color: #666; margin-top: 5px;">Full year unlimited access</div>
                `;
            }
            
            modal.classList.add('show');
        }

        function closePaymentModal() {
            document.getElementById('paymentModal').classList.remove('show');
            document.getElementById('paymentEmail').value = '';
            document.getElementById('paymentName').value = '';
        }

        function closeConfirmModal() {
            document.getElementById('confirmModal').classList.remove('show');
        }

        // ============================================
        // FREE PLAN - MANUAL CALCULATOR
        // ============================================

        function showFreeCalculator() {
            document.getElementById('landingPage').style.display = 'none';
            const calcDiv = document.getElementById('freeCalculator');
            calcDiv.style.display = 'block';
            calcDiv.innerHTML = `
                <div style="background: white; border-radius: 15px; padding: 30px;">
                    <div class="alert alert-success" style="margin-bottom: 30px;">
                        <h2 style="color: #155724; margin-bottom: 10px;">‚úì Free Plan Activated!</h2>
                        <p style="color: #155724; margin: 0;">You can now use manual tax calculations.</p>
                    </div>

                    <h2 style="color: #2d3748; margin-bottom: 20px;">üìä Manual Tax Calculator</h2>
                    
                    <div style="background: #f7fafc; padding: 25px; border-radius: 10px; margin-bottom: 20px;">
                        <h3 style="color: #2d3748; margin-bottom: 15px;">Enter Your Income Details</h3>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #4a5568;">Annual Gross Income (‚Ç¶)</label>
                            <input type="number" id="grossIncome" placeholder="e.g., 5000000" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px;">
                        </div>

                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #4a5568;">Pension Contribution (‚Ç¶)</label>
                            <input type="number" id="pension" placeholder="e.g., 400000" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px;">
                        </div>

                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #4a5568;">NHF Contribution (‚Ç¶)</label>
                            <input type="number" id="nhf" placeholder="e.g., 125000" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px;">
                        </div>

                        <div style="margin-bottom: 20px;">
                            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #4a5568;">Tax Law</label>
                            <select id="taxLaw" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px;">
                                <option value="2025">PITA 2025 (Old Law)</option>
                                <option value="2026" selected>Tax Act 2026 (New Law)</option>
                            </select>
                        </div>

                        <button onclick="calculateTax()" class="btn btn-primary" style="margin-bottom: 10px;">
                            Calculate My Tax
                        </button>

                        <div id="taxResult" style="display: none; margin-top: 20px;"></div>
                    </div>

                    <div style="display: flex; gap: 10px;">
                        <button onclick="goBackToPlans()" class="btn btn-secondary" style="flex: 1;">
                            ‚Üê Back to Plans
                        </button>
                        <button onclick="upgradePlan()" style="flex: 1; padding: 15px; background: #ff9800; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer;">
                            Upgrade to Basic (‚Ç¶500) ‚Üí
                        </button>
                    </div>
                </div>
            `;
        }

        function calculateTax() {
            const grossIncome = parseFloat(document.getElementById('grossIncome').value) || 0;
            const pension = parseFloat(document.getElementById('pension').value) || 0;
            const nhf = parseFloat(document.getElementById('nhf').value) || 0;
            const taxLaw = document.getElementById('taxLaw').value;

            if (grossIncome === 0) {
                alert('Please enter your gross income');
                return;
            }

            // Ask for email to send results
            const userEmail = prompt('Enter your email address to receive the tax calculation results:');
            if (!userEmail || !userEmail.includes('@')) {
                alert('Valid email address required to receive results.');
                return;
            }

            const userName = prompt('Enter your name:') || 'Taxpayer';

            const higherOf1PercentOr200k = Math.max(grossIncome * 0.01, 200000);
            const onePercentOfGross = grossIncome * 0.01;
            const cra = higherOf1PercentOr200k + onePercentOfGross;

            const totalDeductions = pension + nhf + cra;
            const taxableIncome = Math.max(0, grossIncome - totalDeductions);

            let tax = 0;
            let taxLawName = '';
            
            if (taxLaw === '2026') {
                taxLawName = 'Tax Act 2026 (New Law)';
                if (taxableIncome <= 800000) {
                    tax = 0;
                } else if (taxableIncome <= 3200000) {
                    tax = (taxableIncome - 800000) * 0.15;
                } else if (taxableIncome <= 8000000) {
                    tax = 360000 + (taxableIncome - 3200000) * 0.18;
                } else if (taxableIncome <= 20000000) {
                    tax = 1224000 + (taxableIncome - 8000000) * 0.21;
                } else {
                    tax = 3744000 + (taxableIncome - 20000000) * 0.25;
                }
            } else {
                taxLawName = 'PITA 2025 (Old Law)';
                if (taxableIncome <= 300000) {
                    tax = taxableIncome * 0.07;
                } else if (taxableIncome <= 600000) {
                    tax = 21000 + (taxableIncome - 300000) * 0.11;
                } else if (taxableIncome <= 1100000) {
                    tax = 54000 + (taxableIncome - 600000) * 0.15;
                } else if (taxableIncome <= 1600000) {
                    tax = 129000 + (taxableIncome - 1100000) * 0.19;
                } else if (taxableIncome <= 3200000) {
                    tax = 224000 + (taxableIncome - 1600000) * 0.21;
                } else {
                    tax = 560000 + (taxableIncome - 3200000) * 0.24;
                }
            }

            // Show processing message
            const resultDiv = document.getElementById('taxResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <div class="info-box">
                    <h3 style="color: #1976d2; margin-bottom: 15px;">‚è≥ Processing Your Tax Calculation...</h3>
                    <p style="color: #1565c0;">
                        We're calculating your taxes and will send the detailed results to <strong>${userEmail}</strong>
                    </p>
                </div>
            `;

            // Send email with results
            sendTaxCalculationEmail(userEmail, userName, {
                grossIncome,
                pension,
                nhf,
                cra,
                taxableIncome,
                tax: Math.round(tax),
                taxLaw: taxLawName
            });
        }

        function goBackToPlans() {
            location.reload();
        }

        function upgradePlan() {
            goBackToPlans();
            setTimeout(() => selectBasic(), 100);
        }

        // ============================================
        // PAID PLAN - UPLOAD INTERFACE
        // ============================================

        function showUploadInterface(userEmail, userName, plan) {
            document.getElementById('landingPage').style.display = 'none';
            const uploadDiv = document.getElementById('uploadSection');
            uploadDiv.style.display = 'block';
            
            currentUserEmail = userEmail;
            currentUserName = userName;
            
            const registeredUser = getRegisteredUser(userEmail);
            let userStatusHTML = '';
            
            if (registeredUser) {
                userStatusHTML = `
                    <div class="registered-user">
                        <h3 style="color: #2e7d32; margin-bottom: 10px;">‚úì Registered User</h3>
                        <div style="font-size: 14px; color: #1b5e20;">
                            <div style="margin: 5px 0;"><strong>Name:</strong> ${registeredUser.name}</div>
                            <div style="margin: 5px 0;"><strong>Email:</strong> ${userEmail}</div>
                            <div style="margin: 5px 0;"><strong>Plan:</strong> ${plan.toUpperCase()}</div>
                            <div style="margin: 5px 0;"><strong>Total Uploads:</strong> ${registeredUser.uploadCount}</div>
                        </div>
                    </div>
                `;
            }
            
            uploadDiv.innerHTML = `
                <div style="background: white; border-radius: 15px; padding: 30px;">
                    <div class="alert alert-success" style="margin-bottom: 20px;">
                        <h2 style="color: #155724; margin-bottom: 10px;">‚úì ${plan.toUpperCase()} Plan Activated!</h2>
                        <p style="color: #155724; margin: 0;">Welcome, ${userName}! You can now upload your bank statement${plan === 'pro' ? 's' : ''}.</p>
                    </div>

                    ${userStatusHTML}

                    <h2 style="color: #2d3748; margin-bottom: 20px;">üì§ Upload Bank Statement</h2>
                    
                    <div class="info-box">
                        <h3 style="color: #1976d2; margin-bottom: 10px;">üîí Security Notice</h3>
                        <p style="color: #1565c0; font-size: 14px; line-height: 1.6;">
                            ${registeredUser ? 
                                `All uploads must match your registered name: <strong>${registeredUser.name}</strong>` :
                                `Your first upload will register your account holder name. All future uploads must have the same name.`
                            }
                        </p>
                    </div>

                    <div class="upload-zone" id="uploadZone">
                        <div style="font-size: 48px; margin-bottom: 15px;">üìÑ</div>
                        <h3 style="color: #2d3748; margin-bottom: 10px;">Click to Upload or Drag & Drop</h3>
                        <p style="color: #718096; font-size: 14px;">Supported: PDF, Excel (.xlsx, .xls), CSV</p>
                        <p style="color: #718096; font-size: 12px; margin-top: 5px;">Max file size: 10MB</p>
                        <input type="file" id="fileInput" class="file-input" accept=".pdf,.xlsx,.xls,.csv">
                    </div>

                    <div id="uploadStatus"></div>
                    <div id="uploadResults"></div>

                    <button onclick="goBackToPlans()" class="btn btn-secondary" style="margin-top: 20px;">
                        ‚Üê Back to Plans
                    </button>
                </div>
            `;

            setupUploadHandlers();
        }

        function setupUploadHandlers() {
            const uploadZone = document.getElementById('uploadZone');
            const fileInput = document.getElementById('fileInput');

            uploadZone.addEventListener('click', () => fileInput.click());

            uploadZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadZone.classList.add('dragover');
            });

            uploadZone.addEventListener('dragleave', () => {
                uploadZone.classList.remove('dragover');
            });

            uploadZone.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadZone.classList.remove('dragover');
                const file = e.dataTransfer.files[0];
                if (file) handleFileUpload(file);
            });

            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) handleFileUpload(file);
            });
        }

        async function handleFileUpload(file) {
            console.log('File uploaded:', file.name);
            currentFile = file;

            const validTypes = [
                'application/pdf',
                'application/vnd.ms-excel',
                'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
                'text/csv'
            ];

            if (!validTypes.includes(file.type) && !file.name.match(/\.(pdf|xlsx|xls|csv)$/i)) {
                showUploadStatus('error', '‚ùå Invalid file type. Please upload PDF, Excel, or CSV file.');
                return;
            }

            if (file.size > 10 * 1024 * 1024) {
                showUploadStatus('error', '‚ùå File too large. Maximum size is 10MB.');
                return;
            }

            try {
                showUploadStatus('warning', '‚è≥ Extracting account holder name from statement...');
                
                if (file.type === 'application/pdf' || file.name.endsWith('.pdf')) {
                    extractedName = await extractNameFromPDF(file);
                } else if (file.name.match(/\.(xlsx|xls)$/i)) {
                    extractedName = await extractNameFromExcel(file);
                } else if (file.name.endsWith('.csv')) {
                    extractedName = await extractNameFromCSV(file);
                }

                if (!extractedName) {
                    showUploadStatus('error', '‚ùå Could not extract account holder name from the statement. Please ensure the file contains account holder information.');
                    return;
                }

                const registeredUser = getRegisteredUser(currentUserEmail);

                if (registeredUser) {
                    await validateExistingUser(registeredUser);
                } else {
                    await confirmNewUser();
                }

            } catch (error) {
                console.error('Error processing file:', error);
                showUploadStatus('error', '‚ùå Error processing file: ' + error.message);
            }
        }

        async function validateExistingUser(registeredUser) {
            const registeredNormalized = registeredUser.name.trim().toUpperCase();
            const extractedNormalized = extractedName.trim().toUpperCase();

            if (registeredNormalized === extractedNormalized) {
                showUploadStatus('success', `‚úì Account verified! Processing statement...`);
                processStatement();
            } else {
                const resultsDiv = document.getElementById('uploadResults');
                resultsDiv.innerHTML = `
                    <div class="alert alert-error">
                        <h3 style="margin-bottom: 10px;">‚ùå Account Holder Mismatch</h3>
                        <div style="background: white; padding: 15px; border-radius: 8px; margin: 15px 0;">
                            <div style="margin: 10px 0;">
                                <strong>Your Registered Name:</strong><br>
                                <span style="font-size: 18px; color: #28a745;">${registeredUser.name}</span>
                            </div>
                            <div style="margin: 10px 0;">
                                <strong>Name on This Statement:</strong><br>
                                <span style="font-size: 18px; color: #dc3545;">${extractedName}</span>
                            </div>
                        </div>
                        <p style="margin-top: 15px; font-size: 14px;">
                            <strong>üîí Security Notice:</strong> This bank statement belongs to a different person. 
                            For security reasons, you can only upload statements in your own name.
                        </p>
                    </div>
                `;
                showUploadStatus('error', '');
            }
        }

        async function confirmNewUser() {
            const confirmDiv = document.getElementById('confirmDetails');
            confirmDiv.innerHTML = `
                <div class="info-box" style="margin-bottom: 15px;">
                    <p style="color: #1565c0; font-size: 14px; line-height: 1.6;">
                        We've extracted your account holder name from the bank statement:
                    </p>
                </div>
                <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <div style="margin: 10px 0;">
                        <strong>Email:</strong><br>
                        <span style="font-size: 16px;">${currentUserEmail}</span>
                    </div>
                    <div style="margin: 10px 0;">
                        <strong>Account Holder Name:</strong><br>
                        <span style="font-size: 18px; color: #667eea; font-weight: bold;">${extractedName}</span>
                    </div>
                </div>
                <div class="alert alert-warning" style="font-size: 13px;">
                    <strong>‚ö†Ô∏è Important:</strong> This name will be permanently linked to your email. 
                    All future uploads must have the same account holder name.
                </div>
            `;
            
            document.getElementById('confirmModal').classList.add('show');
        }

        function confirmAndRegister() {
            registerUser(currentUserEmail, extractedName);
            closeConfirmModal();
            
            showUploadStatus('success', `‚úì Registration successful! Processing statement...`);
            processStatement();
        }

        function processStatement() {
            updateUploadStats(currentUserEmail);
            
            const resultsDiv = document.getElementById('uploadResults');
            resultsDiv.innerHTML = `
                <div class="info-box" style="margin-top: 20px;">
                    <h3 style="color: #1976d2; margin-bottom: 10px;">‚è≥ Processing Your Statement...</h3>
                    <p style="color: #1565c0; margin-bottom: 15px;">
                        Sending confirmation email to <strong>${currentUserEmail}</strong>...
                    </p>
                </div>
            `;

            // Send email confirmation
            sendUploadResultsEmail(currentUserEmail, currentUserName, {
                fileName: currentFile.name,
                accountHolder: extractedName
            }).then((success) => {
                if (success) {
                    resultsDiv.innerHTML = `
                        <div class="alert alert-success" style="margin-top: 20px;">
                            <h3 style="margin-bottom: 10px;">‚úì Statement Processed Successfully!</h3>
                            <div style="background: white; padding: 15px; border-radius: 8px; margin: 15px 0; color: #155724;">
                                <div style="margin: 8px 0;"><strong>File:</strong> ${currentFile.name}</div>
                                <div style="margin: 8px 0;"><strong>Account Holder:</strong> ${extractedName}</div>
                                <div style="margin: 8px 0;"><strong>Email:</strong> ${currentUserEmail}</div>
                                <div style="margin: 8px 0;"><strong>Status:</strong> <span style="font-weight: bold;">‚úì VALIDATED & CONFIRMED</span></div>
                            </div>
                            <p style="color: #155724; margin-top: 15px;">
                                üìß <strong>Confirmation email sent to ${currentUserEmail}</strong>
                            </p>
                            <p style="color: #155724;">
                                Your bank statement has been validated. You'll receive detailed tax analysis results via email shortly.
                                ${selectedPlan === 'pro' ? ' You can upload more statements anytime!' : ''}
                            </p>
                        </div>
                    `;
                } else {
                    resultsDiv.innerHTML = `
                        <div class="info-box" style="margin-top: 20px;">
                            <h3 style="color: #1976d2; margin-bottom: 10px;">‚úì Statement Validated</h3>
                            <div style="background: white; padding: 15px; border-radius: 8px; margin: 15px 0;">
                                <div style="margin: 8px 0;"><strong>File:</strong> ${currentFile.name}</div>
                                <div style="margin: 8px 0;"><strong>Account Holder:</strong> ${extractedName}</div>
                                <div style="margin: 8px 0;"><strong>Email:</strong> ${currentUserEmail}</div>
                                <div style="margin: 8px 0;"><strong>Status:</strong> <span style="color: #28a745; font-weight: bold;">‚úì VALIDATED</span></div>
                            </div>
                            <p style="color: #1565c0; margin-top: 15px;">
                                Your bank statement has been successfully validated and is ready for AI tax categorization.
                                ${selectedPlan === 'pro' ? 'You can upload more statements or process this one.' : 'Ready for processing.'}
                            </p>
                            <p style="color: #e65100; font-size: 13px; margin-top: 10px;">
                                ‚ö†Ô∏è Email notification could not be sent. Please check EmailJS configuration.
                            </p>
                        </div>
                    `;
                }
            });

            const registeredUser = getRegisteredUser(currentUserEmail);
            if (registeredUser) {
                showUploadStatus('success', `‚úì Upload #${registeredUser.uploadCount} processed successfully!`);
            }
        }

        function showUploadStatus(type, message) {
            const statusDiv = document.getElementById('uploadStatus');
            if (message) {
                const alertClass = type === 'success' ? 'alert-success' : 
                                  type === 'error' ? 'alert-error' : 'alert-warning';
                
                statusDiv.innerHTML = `<div class="alert ${alertClass}">${message}</div>`;
            } else {
                statusDiv.innerHTML = '';
            }
        }

        // ============================================
        // PAYMENT PROCESSING
        // ============================================

        function processPayment() {
            const email = document.getElementById('paymentEmail').value.trim();
            const name = document.getElementById('paymentName').value.trim();

            if (!email || !email.includes('@')) {
                alert('Please enter a valid email address');
                return;
            }

            if (!name) {
                alert('Please enter your full name');
                return;
            }

            const subscription = checkManualSubscription(email);
            
            if (subscription.hasAccess) {
                let message = `‚úì COMPLIMENTARY ACCESS!\n\n`;
                message += `Email: ${email}\n`;
                message += `Plan: ${subscription.plan.toUpperCase()}\n`;
                message += `${subscription.note ? 'Note: ' + subscription.note + '\n' : ''}`;
                message += `${subscription.expiryDate ? 'Valid until: ' + subscription.expiryDate : 'Never expires'}\n\n`;
                message += `No payment needed! Click OK to start.`;
                
                alert(message);
                closePaymentModal();
                
                // Send confirmation email for complimentary access
                sendPaymentConfirmationEmail(email, name, subscription.plan, 0, 'COMP-' + Date.now());
                
                showUploadInterface(email, name, subscription.plan);
                return;
            }

            alert(`Payment integration ready.\n\nEmail: ${email}\nName: ${name}\nPlan: ${selectedPlan}\nAmount: ${selectedPlan === 'basic' ? '‚Ç¶500' : '‚Ç¶3,000'}\n\nPaystack would process payment here. After payment, confirmation email will be sent automatically.`);
            
            closePaymentModal();
            showUploadInterface(email, name, selectedPlan);
        }

        // ============================================
        // EMAIL SENDING FUNCTIONS
        // ============================================

        async function sendTaxCalculationEmail(email, name, taxData) {
            if (EMAILJS_PUBLIC_KEY === "YOUR_PUBLIC_KEY_HERE") {
                const resultDiv = document.getElementById('taxResult');
                resultDiv.innerHTML = `
                    <div class="alert alert-error">
                        <h3 style="margin-bottom: 10px;">‚ùå EmailJS Not Configured</h3>
                        <p>Email sending is not configured yet. Please add your EmailJS keys.</p>
                        <p style="margin-top: 10px; font-size: 14px;">Your calculation results:</p>
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <div>Gross Income: ‚Ç¶${taxData.grossIncome.toLocaleString()}</div>
                            <div>Taxable Income: ‚Ç¶${taxData.taxableIncome.toLocaleString()}</div>
                            <div style="font-weight: bold; margin-top: 10px;">Total Tax Due: ‚Ç¶${taxData.tax.toLocaleString()}</div>
                        </div>
                    </div>
                `;
                console.log('EmailJS not configured');
                return;
            }

            const emailParams = {
                to_name: name,
                to_email: email,
                user_email: email,
                tax_type: `Nigerian Tax Calculation - ${taxData.taxLaw}`,
                calculation_details: `
TAX CALCULATION RESULTS
================================================================================

Tax Law Applied: ${taxData.taxLaw}
Calculated on: ${new Date().toLocaleString('en-NG')}

INCOME & DEDUCTIONS:
Gross Income:              ‚Ç¶${taxData.grossIncome.toLocaleString()}
Pension Contribution:      ‚Ç¶${taxData.pension.toLocaleString()}
NHF Contribution:          ‚Ç¶${taxData.nhf.toLocaleString()}
Consolidated Relief (CRA): ‚Ç¶${taxData.cra.toLocaleString()}

CALCULATION:
Total Deductions:          ‚Ç¶${(taxData.pension + taxData.nhf + taxData.cra).toLocaleString()}
Taxable Income:            ‚Ç¶${taxData.taxableIncome.toLocaleString()}

TOTAL TAX DUE:             ‚Ç¶${taxData.tax.toLocaleString()}

================================================================================

IMPORTANT NOTES:
‚Ä¢ This calculation is for informational purposes only
‚Ä¢ Consult a qualified tax professional before filing
‚Ä¢ Keep this email for your records
‚Ä¢ Upgrade to our paid plans for AI-powered bank statement analysis

Questions? Reply to this email.

Thank you for using Nigerian Tax Calculator!
================================================================================
                `,
                timestamp: new Date().toLocaleString('en-NG')
            };

            try {
                await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, emailParams);
                console.log('Tax calculation email sent to:', email);
                
                const resultDiv = document.getElementById('taxResult');
                resultDiv.innerHTML = `
                    <div class="alert alert-success">
                        <h3 style="margin-bottom: 10px;">‚úì Email Sent Successfully!</h3>
                        <p>Your tax calculation results have been sent to <strong>${email}</strong></p>
                        <p style="margin-top: 10px; font-size: 14px;">
                            Please check your inbox (and spam folder) for the detailed calculation.
                        </p>
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 15px; color: #155724;">
                            <div style="font-weight: bold; font-size: 18px;">Your Tax Due: ‚Ç¶${taxData.tax.toLocaleString()}</div>
                            <div style="font-size: 12px; margin-top: 5px;">Full details sent to your email</div>
                        </div>
                    </div>
                `;
            } catch (error) {
                console.error('Failed to send tax calculation email:', error);
                const resultDiv = document.getElementById('taxResult');
                resultDiv.innerHTML = `
                    <div class="alert alert-error">
                        <h3 style="margin-bottom: 10px;">‚ùå Email Send Failed</h3>
                        <p>We couldn't send the email. Error: ${error.text || error.message}</p>
                        <p style="margin-top: 10px;">Your calculation results:</p>
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <div>Gross Income: ‚Ç¶${taxData.grossIncome.toLocaleString()}</div>
                            <div>Taxable Income: ‚Ç¶${taxData.taxableIncome.toLocaleString()}</div>
                            <div style="font-weight: bold; margin-top: 10px;">Total Tax Due: ‚Ç¶${taxData.tax.toLocaleString()}</div>
                        </div>
                    </div>
                `;
            }
        }

        async function sendPaymentConfirmationEmail(email, name, plan, amount, reference) {
            if (EMAILJS_PUBLIC_KEY === "YOUR_PUBLIC_KEY_HERE") {
                console.log('EmailJS not configured, skipping confirmation email');
                return;
            }

            const emailParams = {
                to_name: name,
                to_email: email,
                user_email: email,
                tax_type: `Payment Confirmation - ${plan === 'basic' ? 'Basic Plan' : 'Pro Plan'}`,
                calculation_details: `
PAYMENT CONFIRMATION
================================================================================

Thank you for your payment!

Payment Reference: ${reference}
Plan: ${plan === 'basic' ? 'Basic Plan - One Upload' : 'Pro Plan - Unlimited Access'}
Amount Paid: ‚Ç¶${amount.toLocaleString()}
Date: ${new Date().toLocaleString('en-NG')}

${plan === 'basic' ? 
  'You can now upload ONE bank statement for AI-powered analysis.' :
  'You now have UNLIMITED uploads for the entire tax year!'}

Next Steps:
1. You can now access the AI-powered bank statement analyzer
2. Upload your bank statements and let AI categorize transactions
3. Get professional tax returns ready for filing

Questions? Reply to this email.

Thank you for choosing our service!
================================================================================
                `,
                timestamp: new Date().toLocaleString('en-NG')
            };

            try {
                await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, emailParams);
                console.log('Payment confirmation email sent to:', email);
            } catch (error) {
                console.error('Failed to send confirmation email:', error);
            }
        }

        async function sendUploadResultsEmail(email, name, fileInfo) {
            if (EMAILJS_PUBLIC_KEY === "YOUR_PUBLIC_KEY_HERE") {
                console.log('EmailJS not configured, skipping upload results email');
                return;
            }

            const emailParams = {
                to_name: name,
                to_email: email,
                user_email: email,
                tax_type: 'Bank Statement Upload - Processing Complete',
                calculation_details: `
BANK STATEMENT PROCESSING COMPLETE
================================================================================

Your bank statement has been successfully validated and is ready for processing.

File Information:
File Name: ${fileInfo.fileName}
Account Holder: ${fileInfo.accountHolder}
Upload Date: ${new Date().toLocaleString('en-NG')}
Status: VALIDATED ‚úì

Next Steps:
1. Our AI will analyze your transactions and categorize them
2. We'll extract all tax-relevant information
3. You'll receive your detailed tax analysis shortly

This email confirms that your upload was successful. You will receive another
email with your complete tax analysis and recommendations.

Questions? Reply to this email.

Thank you for using Nigerian Tax Calculator!
================================================================================
                `,
                timestamp: new Date().toLocaleString('en-NG')
            };

            try {
                await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, emailParams);
                console.log('Upload results email sent to:', email);
                return true;
            } catch (error) {
                console.error('Failed to send upload results email:', error);
                return false;
            }
        }

        // ============================================
        // INITIALIZATION
        // ============================================

        window.onload = function() {
            console.log('=== Tax Calculator Loaded ===');
            console.log('EmailJS:', EMAILJS_PUBLIC_KEY !== 'YOUR_PUBLIC_KEY_HERE' ? 'Configured ‚úì' : 'Not configured ‚úó');
            console.log('PDF.js:', typeof pdfjsLib !== 'undefined' ? 'Loaded ‚úì' : 'Not loaded ‚úó');
            console.log('SheetJS:', typeof XLSX !== 'undefined' ? 'Loaded ‚úì' : 'Not loaded ‚úó');
            console.log('Paystack:', typeof PaystackPop !== 'undefined' ? 'Loaded ‚úì' : 'Not loaded ‚úó');
            console.log('Manual Subscriptions:', Object.keys(MANUAL_SUBSCRIPTIONS).length);
            
            if (EMAILJS_PUBLIC_KEY === 'YOUR_PUBLIC_KEY_HERE') {
                console.warn('‚ö†Ô∏è EmailJS not configured! Email sending will not work.');
                console.log('üìñ See SETUP_EMAILJS.md for configuration instructions');
            }
            
            console.log('All systems ready! üöÄ');
        };
    </script>
</body>
</html>